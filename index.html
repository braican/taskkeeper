<!DOCTYPE html>
<html lang="en" ng-app="taskkeeper">
<head>
    <meta charset="UTF-8">
    <title>Taskkeeper</title>
    <link rel="stylesheet" href="css/main.css">
    <script src="js/vendor/angular.min.js"></script>
    <script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
    <script src="https://cdn.firebase.com/libs/angularfire/1.1.3/angularfire.min.js"></script>
    <script src="js/taskkeeper.js"></script>
</head>
<body>
    <div id="tk-svg-sprite" style="height: 0; width: 0; position: absolute; visibility: hidden"></div>

    <div class="tk-app" ng-controller="ClientController as clientList" ng-class="{ drawerActive: clientList.drawerActive }">

        <header class="tk-header">
            <span class="icon icon--arrow tk-activate-drawer" ng-click="clientList.drawerActive = !clientList.drawerActive"><svg><use xlink:href="#icon--arrow"></use></svg></span>
            <h1 class="app-name">Taskkeeper</h1>
        </header>

        <div class="tk-sidebar">
            <header>
                <span class="icon icon--arrow tk-activate-drawer" ng-click="clientList.drawerActive = !clientList.drawerActive"><svg><use xlink:href="#icon--arrow"></use></svg></span>
                <h3>Clients</h3>
            </header>
            <div class="tk-clients">
                <ul>
                    <li ng-repeat="(clientName, client) in clientList.clients | orderBy:'hourlyRate'" ng-click="clientList.selectClient(clientName)" ng-class="{active: clientList.isSelected(clientName)}">
                        <strong>Name: </strong>{{clientName}} <br>
                        <strong>Rate: </strong>{{client.hourlyRate | currency}} <br>
                        <strong ng-show="client.outstandingInvoice">Outstanding Invoice</strong>
                    </li>
                    <li class="add-new-client">+</li>
                </ul>
            </div>
        </div>
        

        <div class="tk-content">
            <div class="tk-client-detail" ng-repeat="(clientName, client) in clientList.clients" ng-show="clientList.isSelected(clientName)">
                <header>
                    <h2 class="client-name">{{clientName}}</h2>
                    <span class="client-rate">{{client.hourlyRate | currency}}</span>
                </header>

                <ul class="client-hours">
                    <li>
                        <span class="key">Billable Hours</span>
                        <span class="value">{{ clientList.totalHours( client ) }}</span>
                    </li>
                    <li>
                        <span class="key">Total Due</span>
                        <span class="value">{{ clientList.totalDue( client ) | currency }}</span>
                    </li>
                </ul>

                <div class="client-tasks">

                    <form class="add-new-task" name="newTask" ng-submit="clientList.addTask( clientName )" novalidate>
                        <input type="text" name="taskName" placeholder="Add new task" ng-model="clientList.task.description" required>
                        <input type="number" name="taskHours" step="any" placeholder="hours" ng-model="clientList.task.hours">
                        <button type="submit" ng-disabled="newTask.$invalid">+</button>
                    </form>

                    <ul class="task-list">
                        <li ng-repeat="(taskId, task) in client.tasks">
                            <div class="task-data">
                                <span class="description">{{task.description}}</span>
                                <span class="hours">{{task.hours}}</span>
                            </div>

                            <div class="actionable">
                                <a href="#" class="task--edit" ng-click="clientList.editTask(clientName, taskId)">Edit</a>
                                <a href="#" class="task--remove" ng-click="clientList.removeTask(clientName, taskId)">Remove</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
</body>
</html>